# 修改记录

## Todo

- 完成 docker 部署
- 添加任务上传图片在前端进行压缩后再上传，节省服务器空间。

## 20251028 修改记录

- 添加任务-批量添加，点击智能识别，然后添加选中任务还是失败，请修复，检查前端后端哪里出了问题。


## 20251027 修改记录

- “我的”页面，个人中心下方显示用户昵称，如用户未设置昵称，显示用户名。✅
- 登录页面增加记住用户名和密码功能，用户勾选后，下次登录时自动填充用户名和密码。❌（暂不考虑）
- 我的荣誉墙页面，每个荣誉的获得次数，显示到荣誉卡的右上角，不要在荣誉图片那里显示，那里显示不全。✅

### 子账号问题

- 子账号和主账号“我的荣誉”页面需要显示一致。✅
- 点击子账号管理，修改子账号，权限设置选择了 可编辑，但是点击保存修改后，子账号列表中还是显示的是“权限：仅查看”，请修改。✅
- 子账号列表中可以修改已建子账号的昵称和头像。✅
- 子账号管理页面中，“子账号列表” 放到 “创建子账号上方”；子账号列表中可以修改已建子账号的权限。✅
- “仅查看”权限的子账号，“我的”页面中“子账号管理”、“编辑个人信息”、“清除数据”按钮需隐藏，不可操作。✅
- “仅查看”权限的子账号，设置页面中“番茄钟设置”、“任务设置”功能按钮需恢复可见，需要可以操作。✅
- “仅查看”权限的子账号，设置页面中“番茄钟设置”、“任务设置”、“学科设置”、“金币设施”等功能按钮需隐藏，不可操作。✅
- 仅查看权限的子账号，“小心愿”页面“兑换”、“创建心愿”按钮为灰色，不可进行兑换和创建心愿操作，但是点击“领取记录”可以显示完整的“领取记录”，子账号和主账号领取记录显示需一致。✅
- 操作记录中添加取消"操作人"字段，增加用户昵称字段，显示是那个用户进行了本操作，主账号和子账号操作记录，双方在操作记录中都可以看到。✅
- 子账号和主账号操作记录需要显示一致，操作记录中增加"操作人"字段，显示操作的子账号或主账号。✅

- 在"我的"页面的账号管理功能区域下方，新增一个视觉清晰的"子账号管理"按钮。当用户点击该按钮时，系统应弹出"子账号管理"页面。在此页面中，需要实现以下功能：

1. 用户输入框：允许主账号输入子账号的头像、昵称、用户名（用于子账号登录）和密码，用户名需与数据库中已有用户名不重复
2. 权限设置选项：为新创建的子账号提供"仅查看"和"可编辑"两种权限选择
3. 创建按钮：完成子账号创建操作

子账号权限具体定义如下：

- "仅查看"权限：子账号登录后，系统应禁用所有添加、编辑、删除和设置功能，用户只能浏览内容
- "可编辑"权限：子账号拥有与主账号相同的操作权限，但明确禁止子账号禁止删除主账号的操作

此外，主账号应拥有对子账号的管理权限，包括查看所有子账号列表和删除子账号的功能。✅

### 其他问题

- 在"小心愿"页面实现兑换功能，具体要求如下：当用户点击"兑换"按钮时，系统应弹出一个确认弹窗，该弹窗需包含当前小心愿的兑换数量信息供用户确认。用户点击确认按钮后，系统需执行兑换操作，完成后显示兑换成功的提示信息，内容需明确包含"兑换成功 xxx"（其中 xxx 为具体小心愿名称）以及本次兑换所扣除的金币数量。请确保整个流程交互流畅，状态反馈清晰准确。✅
- 当用户勾选"固定番茄钟页面"选项时，点击番茄钟页面外的其他区域时，番茄钟页面依旧显示，只有番茄钟倒计时结束或用户点击结束后，才能关闭番茄钟页面。✅
- 如果我的页面，番茄钟设置为勾选“固定番茄钟页面”，当 按下番茄钟暂停按钮，再次点击“继续”时，番茄钟页面自动变为悬浮球。✅
- 番茄钟页面中，“重置”按钮替换为“暂停”按钮，点击后暂停当前番茄钟倒计时，用户可继续点击“暂停”按钮重新开始倒计时。✅
- 实现一个番茄钟功能，要求在用户刷新页面后，当前正在进行的番茄钟状态能够被完整保留。具体实现需确保以下几点：1) 当番茄钟处于运行状态时，刷新页面后应继续计时，显示正确的剩余时间；2) 已完成的番茄钟数量和当前周期状态也需持久化保存；3) 时间数据的存储方式应可靠且兼容主流浏览器；4) 页面重新加载后，番茄钟应能无缝恢复到刷新前的状态，包括暂停/运行状态和剩余时间显示。 ✅
- 在"添加任务"和"编辑任务"两个功能模块中，实现图片上传功能时，需要在前端对用户选择的图片文件进行压缩处理后再执行上传操作。压缩处理应兼顾图片质量和文件大小，以达到节省用户网络流量和服务器存储空间的双重目标。同时，在"我的"页面的任务设置中，需添加图片压缩比例的配置功能，允许用户根据需求自定义压缩参数。实现时应确保压缩算法高效稳定，压缩过程不阻塞主线程影响用户体验，并提供压缩前后的文件大小对比信息。

- 在应用的"我的"页面中，新增一个视觉清晰的"关于"按钮。该按钮点击后应弹出一个模态窗口或新页面作为关于页面，页面内容需包含以下要素：

1. 软件名称：明确软件图标“frontend\static\images\favicon\android-chrome-192x192.png”（大小合适）、显示"任务积分助手"
2. 版本号：从指定的 JSON 配置文件中读取当前版本号并显示，确保开发人员可通过修改 JSON 文件更新版本号，用户可直观查看应用的当前版本信息
3. "关注小红书"按钮：点击后应使用系统默认浏览器或应用内浏览器跳转到指定的小红书账号页面
4. "邮件联系"按钮：点击后应触发邮件客户端，自动填写收件人为terlun@foxmail.com，方便用户直接发送邮件联系。
   关于页面的设计应保持与应用整体风格一致，布局合理，各元素间距适当，确保在不同屏幕尺寸下均有良好的显示效果和用户体验。✅

- 在"我的"页面设置模块中，添加一个名为"金币设置"的功能按钮。点击后触发弹窗或新页面显示当前用户的总金币数量。页面需包含以下功能元素：1) 只读的当前总金币数量显示区域；2) 可编辑的金币数量输入框；3) 多行文本输入框用于填写修改原因（必填项，限制最少 2 个字符）；4) "保存修改"和"取消"按钮。实现时需确保：修改操作需进行合法性验证，输入修改原因后点击保存按钮时，将新金币数量及修改原因通过安全的 API 请求提交至后端，并保存到数据库中。操作完成后提供明确的成功/失败反馈提示，并在成功时实时更新界面显示的金币数量。✅

## 20251024 修改记录

- 批量添加任务后，不要刷新整个页面，只刷新添加的任务列表，这样用户体验会好些。✅
- 添加/编辑任务时，上传图片后，下方无法预览图片整体，图片没有缩放到一个可以看全图的状态。✅
- 学科设置，已添加到学科可以拖拽顺序，对应添加任务，学科分类下拉菜单的显示顺序。✅
- 学科设置中，添加新学科，未能成功添加；学科设置页面需要可以滚动调节，高度可以自适应，以适应不同浏览器、手机页面的高度。✅
- “我的”页面设置中增加“学科设置”按钮，点击后显示现有的学科及学科颜色，可以修改学科名字、学科颜色，删除学科、可以添加新的学科；“作业打卡”页面，添加任务中学科分类与设置中的学科是关联一致的，数据需要可保存到数据库。✅
- 添加任务点击后，下方有 2 个标签页，分别是“单个添加”、“批量添加”，单个添加显示目前的界面内容，“批量添加”包含“作业文本”，下方有个文本框，用户输入老师不知的当天作业，含多个内容项，文本框下方有个“智能识别按钮”，点击后，下方有个识别结果区域，显示自动识别的多个任务，每个任务可以点击进一步编辑，最下方有个“添加选中任务”按钮，点击后正式添加到“作业打卡”页面。✅
- 在“我的”页面，设置中增加按钮“任务设置”，当复选框选择任务自动排序后：作业打卡页面中任务清单中，学科下方的任务中，已完成任务排到下方；当该学科任务都完成时，将未完任务的学科排到上方。✅
- 修复删除已完成任务时金币扣除问题。✅
- 请实现一个日期选择交互功能，具体要求如下：当用户在日期选择界面中点击不同日期时，下方显示的任务标题应实时更新为对应日期的任务标题。例如，若当前显示"今日任务"且系统日期为 10 月 24 日，当用户点击 10 月 25 日日期时，下方任务标题区域需立即更新为"10 月 25 日任务"；当用户点击 10 月 23 日日期时，下方任务标题区域需相应更新为"10 月 23 日任务"。确保日期选择与任务标题更新之间的交互响应及时、准确，且视觉反馈清晰明确。✅

## 20251023 修改记录

- 删除任务时，总分数中也对应删除获得的任务积分。✅
- 添加/编辑任务中，任务描述下方增加“任务图片”，用户可以上传多张图片，点击保存后，任务页面预计完成时间左侧多出一个图片图标，点击图标可以左右翻页查看上传的图片，适合老师布置了带图片的作业时使用，上传的图片保存到服务器 backend\uploads 文件夹下用户目录中，上传的图片以时间戳+图片名命名（年月日时分秒-图片名），多张图片同时上传时避免命名冲突。✅
- 登录页面下方，不要显示底部导航栏。✅
- 用户可以在"我的"页面中设置标题下方点击"番茄钟设置"按钮，会弹出一个模态窗口，在其中可以勾选"固定番茄钟页面"选项。当勾选此选项后，番茄钟将保持全屏显示，不会缩小为悬浮球，直到计时完成或用户手动关闭窗口，，适合孩子专注做作业。✅
- 我的页面新增设置标题 标题下方增加个 番茄钟设 勾选 固定番茄钟页面 之后，点击任务番茄钟页面开始按钮之后不缩小为悬浮球，而是固定番茄钟页面 让孩子专注做作业直到计时完成 用户点击关闭窗口。✅
- 番茄钟悬浮球动态效果，不要超出悬浮球的范围，动态效果颜色修改为浅蓝色，悬浮球修改颜色，与动态效果匹配，使得整个动画效果更好看。✅
- 作业打卡 页面，任务列表中，任务时间和任务积分，与任务描述放到同一行，并增加显示任务实际消耗时间（显示效果 图标 实际时间），任务实际完成时间为番茄钟点击结束时的实际时间。✅
- 番茄钟页面，增加一个正计时选项，选择后点击开始，开始正计时，点击结束按钮，停止正计时，任务栏中显示任务实际消耗时间。✅

## 20251022 修改记录

- 操作记录页面，检查美化调整、关闭按钮功能、居中显示、滚动及自适应能力是否都已实现。✅
- “我的”页面，点击操作记录，可以查看用户所有的操作记录，记录用户最近 1 个月的操作记录，超过 1 个月的操作记录删除。操作记录页面右上角需要有关闭按钮，每页显示 10 条记录，可以自动翻页，页面大小可以滚动，可以跟随浏览器大小自动调节。✅
- 我的荣誉墙中，荣誉名称需要与 frontend\static\images\honors 中图片名称一致，使其与这 20 个图标对应，并更新对应的荣誉获得逻辑，确保达到条件好，可以正确取得荣誉徽章，并给出庆祝效果；我的荣誉墙页面右上角的关闭按钮，还是看不清，取消我的荣誉墙 上面的渐变色。✅
- 点击我的荣誉墙 外侧区域，自动关闭页面；我的荣誉墙页面需要可以滚动调节，高度可以自适应，以适应不同浏览器、手机页面的高度。✅
- 我的页面中，我的荣誉，设计为点击我的荣誉，弹出一个页面展示荣誉墙，需设计荣誉达成的逻辑，判断什么条件获取哪个荣誉，用户获得的荣誉需要在后台中设计，每个荣誉需要展示漂亮的图标，并且可以展示每个荣誉获得的次数，每次获得荣誉后，弹出庆祝的效果告知用户。✅
- 创建心愿按钮与下方心愿距离太近，调整下间距；参考图片，可用金币在最左侧，领取记录在最右侧，调整样式让页面更漂亮些
- 编辑心愿图标默认隐藏，点击心愿后，才显示出来
- 内置心愿也是可以编辑的，请修改；心愿增加“兑换数量”属性，可以设置数字，比如所需金币 1，兑换数量 10，单位 分钟，代表 兑换 看电视心愿，1 金币可以兑换 5 分钟。

## 20251021 修改记录

- 编辑个人信息，更换了头像之后，点击刷新，又恢复了默认，感觉是后台没有保存个人信息设置，而且还要实现 头像 用户需要可以自定义上传。✅

- 添加\编辑任务，重复设置需包含：无、每天、每个工作日、每周（周一~、~周日可选）；需要可以设置，开始日期和结束日期，默认开始日期为当天，请修改 UI 及后台逻辑，修改后端 py 文件，不要随意修改返回类型，会导致其他相关的错误。✅
- 需整体美化添加\编辑任务窗口，使其排版、布局更漂亮美观、符合学生审美。✅
- 重点关注创建的重复任务，“每天、每个工作日、每周（周一~、~周日可选）”这些任务对应的创建、修改需要符合实际使用要求。✅

## 20251020 修改记录 ✅

- 每个页面顶部增加一个有趣的标题和设计元素（AI 生成），如"作业打卡"页面最上方显示用户头像和用户昵称；“小心愿”页面上方显示“「用户昵称」的心愿收集”；“我的”页面上方显示用户昵称、用户 ID 及用户头像。✅
- 我的页面可以退出当前登录，点击退出后，会跳转到登录页面。✅
- 我的页面可以编辑当前用户的个人信息，包括昵称、头像、修改密码、手机号等，用户可以选择头像（给出 10 个可选头像）或上传头像。✅
- “作业打卡”页面取消“返回今天”按钮，日期选择与周视图过于紧凑，需根据界面大小自动调整，支持小屏幕、电脑、平板等不同设备显示。✅

- 默认头像使用 frontend\static\images\avatars\default.svg，目前头像未能正常显示；“作业打卡”页面“2025 年 10 月第 42 周”居中显示，右侧显示一个小圆圈包裹浅绿色背景的“本周”按钮，点击后返回到今日；“周一 20”都选中状态，而非只显示选中了 20；今日任务放到“全部学科”的上方，其同一行右侧有全部、已完成、待完成 可供筛选；任务菜单栏点击显示不对，需要显示 编辑、番茄钟、删除按钮，按钮左侧需要有对应图标。✅

- 日时长、任务数、日金币、完成率、总金币 上方需要有一个图标；日时长需要统计今日任务完成的总时间；任务数统计今日总任务个数、日金币统计今日获得的金币个数，完成率计算今日任务完成的百分比，总金币统计当前账号总的金币个数。 “作业打卡” 、“小心愿”、“我的”页面的样式不够现代化、美观话，请重新美化设计，让儿童更喜欢。✅

- “作业打卡” 、“小心愿”、“我的”页面分别有不同的背景颜色，使其看起来更漂亮。✅
- 用户还可以在“我的”页面自定义 3 个页面的背景颜色或背景图片，背景图片需支持上传本地图片，给上一次遮罩效果。（未来实现）
- 总金币图示未能正常显示；“小心愿”、“我的”页面 不显示 日时长、任务数、日金币、完成率、总金币，仅在“作业打卡”页面显示。✅

- 总金币上方图标修改为金钱相关图标。✅
- 底部导航栏占据高度过高，请将其调整为合适的高度，与常见手机 App 底部导航栏高度一致。✅
- 今日任务与上方的星期 距离过近，需增加一些间距。✅
- 右下角添加任务图标，和任务菜单图标重叠，请把图标往左侧调整位置，与任务菜单图标错开。✅

- 今日任务 右侧 全部、已完成、待完成按钮点击没有反应。✅
- “作业打卡”页面“2025 年 10 月第 42 周” 下方的周一、周日 距离页面编辑太近了，影响美观，请调整。✅

## 番茄钟功能完善

- “作业打卡” 、“小心愿”、“我的”、“登录”页面不要显示悬浮的番茄钟。✅
- 当点击任务的番茄钟按钮时，弹出番茄钟页面，点击开始后，番茄钟缩小为悬浮球，显示倒计时。✅
- 番茄钟页面右上角需要有个关闭按钮。✅
- 悬浮球页面需显示浅蓝色透明背景，像装水容器一样随时间慢慢变满，需要动的效果。✅
- 当番茄钟正在倒计时时，点击悬浮番茄钟，番茄钟页面弹出，点击番茄钟页面旁边任意区域时，番茄钟页面缩小为悬浮球状态。✅
- 悬浮番茄钟显示位置：位于底部导航栏正中间位置上方。✅
- 番茄钟需要可以自定义设置时间，默认 20 分钟；从任务中点击番茄钟，番茄钟倒计时时间与该任务时间相同。✅
